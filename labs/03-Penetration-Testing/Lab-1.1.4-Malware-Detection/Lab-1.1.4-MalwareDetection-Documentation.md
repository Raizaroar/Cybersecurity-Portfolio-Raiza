# Project Overview

Introduction to fundamental malware detection techniques using cryptographic hashing and VirusTotal threat intelligence platform. This lab demonstrates professional methodology for identifying malicious files WITHOUT execution, a critical skill for SOC analysts responding to potential malware incidents.

**Real-World Application:**  

Every day, SOC analysts receive alerts about suspicious files. The first step is NEVER to execute the file, but to generate its hash and query threat intelligence databases. This lab teaches that exact workflow.

---

## Lab Environment

- **Analysis System:** Kali Linux (VM, isolated)
- **VirusTotal Account:** Free tier (500 API requests/day)
- **Internet Connection:** Required for VirusTotal access
- **Safety:** Hash-only analysis (no malware download/execution)

---

## Prerequisites

- Lab 1.1.3 completed (Wireshark network analysis)
- Kali Linux VM operational
- Internet connectivity
- VirusTotal account created
- Basic understanding of file systems

### Real-life scenario:

I'm an SOC Analyst and a user reports that **they have downloaded a suspicious file**. My job is to:

- Obtain the file hash without executing it.
- Check the hash against malware databases.
- Determine whether it is malicious.
- Document the indicators of compromise (IOCs).
- Recommend actions.

## STEP BY STEP - LABORATORY 1.1.4

### STEP 1.1.4.1: Understanding Cryptographic Hashing

***What is a Cryptographic Hash?*** A hash is a unique “fingerprint” of a file. If you change a single bit of the file, the hash changes completely.

 **Hash Function Example**

**Original file:** `malware.exe` (1 MB)  
- **MD5:** `d41d8cd98f00b204e9800998ecf8427e`  
- **SHA256:** `e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855`

**Modified file:** `malware_modified.exe` (1 MB, 1 bit changed)  
- **MD5:** `7c6f0f1f09d7f9e5f5d5e5c5e5f5e5e5` ← *Completely different*  
- **SHA256:** `a665a45920422f9d417e4867efdcf4b8a04a1f3fff1fa07e998e86f7f7a27ae3`

---

**Hash Algorithm Comparison**

| Algorithm | Length               | Security Status                          | Use Case                        |
|-----------|----------------------|------------------------------------------|----------------------------------|
| **MD5**   | 32 characters (128 bits)  |  Deprecated (collision-prone)         | Legacy malware databases         |
| **SHA1**  | 40 characters (160 bits)  |  Deprecated                           | Older threat intelligence        |
| **SHA256**| 64 characters (256 bits)  |  Secure (current standard)            | Modern malware detection         |
| **SHA512**| 128 characters (512 bits) |  Very secure                          | High-security applications       |

**Practice: Generating Hashes of Benign Files**

In Kali Linux:

***Create a test field***

```bash
echo "This is a test file" > test.txt
```

***use MD5***

```bash
md5sum test.txt
```

Output: 5dd39cab1c53c2c77cd352983f9641e1  test.txt

***use SHA1***

``` bash 
sha1sum test.txt
```

Output: b56df8ed5365fca1419818aa384ba3b5e7756047  test.txt


***Generar SHA256***

```bash
sha256sum test.txt
```

Output: c87e2ca771bab6024c269b933389d2a92d4941c848c52f155b9b84e1f109fe35  test.txt

![lab1.1.4-MalwareDetection](/assets/screenshots/03-Penetration-Testing/Lab-1.1.4-MalwareDetection/Lab-1.1.4-MalwareDetection1.png)

***Add a new character***

```bash
echo "This is a test file!" > test.txt
```

***use SHA256 again***

```bash
sha256sum test.txt
```

Output: 722abf5c74f4b672151b872c4592b8700702e0f597174c2ea6ad63d0b8d842eb  test.txt

![lab1.1.4-MalwareDetection](/assets/screenshots/03-Penetration-Testing/Lab-1.1.4-MalwareDetection/Lab-1.1.4-MalwareDetection3.png)

### STEP 1.1.4.2: Configure VirusTotal Account**

**Create an API key**

![Lab1.1.4-MalwarwDetetion](/assets/screenshots/03-Penetration-Testing/Lab-1.1.4-MalwareDetection/Lab-1.1.4-MalwareDetection4.png)

## STEP 1.1.4.3: Hash-Based Detection (Safest Method)

**Sample 1: Locky Ransomware (Hash Analysis)**

***Locky*** is a notorious ransomware from 2016. Its hash is publicly known. 

***SHA256 of Locky malware (known sample):***

```bash
afec2b2af3ace2c478382f9366f6cbc9b9579f2c9a4273150fc33a2ccd59284c
```

**Locky Ransomware Sample Analysis**

- **Detection Ratio:** 60/68
- **60** antivirus engines detected it as malicious
- **68** total engines analyzed it
- **91.8%** detection rate = HIGH CONFIDENCE that it is malware


![Lab1.1.4-MalwarwDetetion](/assets/screenshots/03-Penetration-Testing/Lab-1.1.4-MalwareDetection/Lab-1.1.4-MalwareDetection5.png)

Explore the detailed hash analysis and forensic notes on a known Locky ransomware sample:

 [View Locky Ransomware Analysis on GitHub](https://github.com/Raizaroar/Cybersecurity-Portafolio-Raiza/blob/main/labs/03-Penetration-Testing/Lab-1.1.4-Malware-Detection/samples-analysis/Locky-Ransomware.md)
