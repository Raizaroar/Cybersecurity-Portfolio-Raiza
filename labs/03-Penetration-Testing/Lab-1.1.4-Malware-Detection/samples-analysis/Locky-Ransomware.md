# Malware Analysis: Locky Ransomware

- **Date:** 19-01-2025  
- **Analyst:** Raiza Rosas
- **Sample:** Locky ransomware variant  
- **Analysis Method:** Hash-based (VirusTotal)

---

## Sample Information

**File Hash (SHA256):**

```
afec2b2af3ace2c478382f9366f6cbc9b9579f2c9a4273150fc33a2ccd59284c
```

- **File Type:** PE32 executable (Windows)  
- **File Size:** 123 KB  
- **First Seen:** 2016-02-16  

---

## Detection Results

**VirusTotal Detection:** 60/68 (91.8%)  
**Community Score:** Malicious (-100)  
**Classification:** Ransomware

**AV Vendors Detection Names:**

- Microsoft: Ransom:Win32/Locky.A
- Kaspersky: Trojan-Ransom.Win32.Locky
- Symantec: Trojan.Ransomcrypt
- McAfee: Ransom-Locky!
- Avast: Win32:Malware-gen

---

## Indicators of Compromise (IOCs)

### Network IOCs

**C2 Servers (Command & Control):**
- IP: 185.117.153.12
- IP: 192.42.116.215
- Domain: ransomware-c2.example.com

### File IOCs

**Created Files:**
- C:\Users\[username]\Desktop\HELP_DECRYPT.txt (ransom note)
- C:\ProgramData\locky.exe (persistent copy)

### Registry IOCs

**Modified Keys:**
- HKCU\Software\Locky (configuration storage)
- HKLM\Software\Microsoft\Windows\CurrentVersion\Run (persistence)

---

## Behavior Summary

**Malware Family:** Locky Ransomware  

**Attack Vector:** Malicious email attachment (typically)  

**Impact:** File encryption (ransomware)  

**Typical Infection Chain:**

1. User opens malicious email attachment
2. Macro executes and downloads Locky
3. Locky encrypts user files
4. Ransom note displayed demanding Bitcoin payment

---

## MITRE ATT&CK Mapping

- **T1566.001:** Phishing: Spearphishing Attachment (initial access)
- **T1486:** Data Encrypted for Impact (ransomware)
- **T1547.001:** Boot or Logon Autostart Execution: Registry Run Keys
- **T1071.001:** Application Layer Protocol: Web Protocols (C2)

---

## Recommendation

**Severity:** CRITICAL  
**Action:** BLOCK immediately

**If detected on network:**

1. Isolate affected system immediately
2. Block IOCs at firewall/proxy (IPs, domains)
3. Scan all systems for hash match
4. Check backups for restoration options
5. DO NOT pay ransom (fuels criminal activity)

---

## References

- VirusTotal: https://www.virustotal.com/gui/file/[hash]
- MITRE ATT&CK: https://attack.mitre.org/